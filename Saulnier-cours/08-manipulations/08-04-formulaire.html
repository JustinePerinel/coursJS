<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <!-- ajouter la ligne pour boodstrap -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>VIII - 04 - Un formulaire</title>
    <!-- reset  -->
    <!-- <link rel="stylesheet" href="../css/reset.css"> -->
    <!-- mes styles en externe -->
    <!-- <link rel="stylesheet" href="../css/style.css"> -->

    <!--async permet de charger le html en premier et adapter le script, ce qui permet de trouver les identifiants du html p1,p2,.. et lancer le script JS une fois le html lu-->

    <!-- Ajouter le CSS boodstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <!-- script en externe -->
    <!-- <script src="selecteur.js"></script> -->
    <!-- style interne si besoin -->
    <style>
        .error {
            border: solid red;
        }

        .valide {
            border: solid green;
        }
    </style>
</head>

<body>
    <!-- jumbotron / container / row/ col -->
    <div class="jumbotron ">
        <h1 id="titreNiveau1" class="display-4">JS - VIII 04 - Formulaire</h1>
        <p class="lead">Un formulaire</p>
    </div>
    <!--fin jumbotron-->

    <!-- Début de container -->
    <div class="container border border-info p-5">

        <div class="row border border-info my-3 p-3">
            <div class="col-6 ">
                <h2>Fonction controleForm()</h2>
            </div>
            <!--fin col-6-->

            <div class="col-6 my-2 p-2">
                <!-- form pour forumaire, avec action formulaire, ou formulaire php ou juste "" -->
                <!-- class form-inline sert à avoir le formulaire sur une ligne
                    la div form-group permet de les grouper ensemble pour permettre les marges systematiques entre éléments -->
                <form action="formulaire" method="GET" name="formulaire" class="form-inline">

                    <div class="form-group m-1">
                        <!-- label c'est l'étiquette du champs -->
                        <label for="pseudo" class="sr-only">Pseudonyme</label>
                        <!-- input pour permettre la saisie, c'est la champs -->
                        <input type="text" name="pseudo" id="pseudo" placeholder="Votre pseudo">
                    </div>

                    <!-- sr-only sert à cacher les noms d'input -->
                    <div class="form-group m-1">
                        <label for="mdp" class="sr-only">Mot de passe</label>
                        <input type="password" name="mdp" id="mdp" placeholder="Mot de passe">
                    </div>
                    <!-- le bouton qui permet de soumettre la saisie -->
                    <!-- la class onclick pour activer la fonction js par bouton-->
                    <button type="submit" id="submit" value="ok" class="btn-sm"
                        onclick="controleForm()">Envoyer</button>

                </form>
                <!--fin de formulaire-->
            </div>
            <!--fin col-6-->
        </div>
        <!--fin row-->

        <div class="row">
            <div class="col-3">
                <h2>Nouvelle fonction inscriptionForm()</h2>
            </div>
            <!--fin de col 6-->

            <div class="col-9 border border success bg-secondary">
                <form action="inscription" method="GET" name="inscription" class="form-inline" id="formInscription">

                    <div class="form-group my-2 p-1 text-white">
                        <label for="prenom">Prénom*</label>
                        <input type="text" name="prenom" id="prenom" placeholder="Votre prénom" class="mx-2">
                    </div>

                    <div class="form-group my-2 text-white">
                        <label for="nom">NOM*</label>
                        <input type="text" name="nom" id="nom" placeholder="Votre nom" class="mx-2">
                    </div>

                    <div class="form-group my-2 text-white">
                        <label for="email">Email*</label>
                        <input type="text" name="email" id="email" placeholder="Votre email" class="mx-2">
                    </div>

                    <div class="form-group my-2 text-white mx-2">
                        <label for="mdp">Choisissez un mot de passe*</label>
                        <input type="password" name="mdp" id="mdp2" placeholder="Votre mot de passe" class="mx-2">
                    </div>

                    <div class="form-group my-2 mx-2 text-white">
                        <label for="confmdp">Confirmer votre mot de passe*</label>
                        <input type="password" name="confmdp" id="confmdp" placeholder="Confirmation mot de passe"
                            class="mx-2">
                    </div>

                    <div class="form-group my-2 mx-2">
                        <button type="submit" id="submit2" value="inscription" class="my-2 mx-2 btn btn-warning">S'inscrire</button>
                        <button id = "resetForm" class="btn btn-warning">Effacer</button> <!--type reset est le plus rapide mais on peut faire une fonction à l'id resetForm dans ce cas-->
                        <!-- <button type = "reset" class="btn btn-warning">Effacer</button> -->
                    </div>

                </form>
                <!--fin de formulaire-->
            </div>
            <!--fin de col 6-->
        </div>
        <!--fin de row-->

    </div>
    <!--fin de container-->

    <!-- Le JS de boostrap est optionnel -->
    <!-- En 1er JQuery, puis Popper.js et le JS de Bootstrap -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"
        integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s"
        crossorigin="anonymous"></script>

    <!-- Mes scripts !!! -->

    <script>
        // controle du formulaire avec une fonction

        function controleForm() {
            // event = évènement :
            event.preventDefault(); //pour empecher l'envoi du formulaire, à enlever en Prod
            // pour s'assurer que le pseudo fait pas moins de 5 caractères
            // attention à l 'écriture de length GTH en fin
            if (document.formulaire.pseudo.value.length < 5 || document.formulaire.pseudo.value.length > 15) {
                console.log(document.formulaire.pseudo.value);
                alert('Le pseudo doit comporter entre 5 et 15 caractères');
            } // fin du if

            if (document.formulaire.mdp.value.length < 3 || document.formulaire.mdp.value.length > 12) {
                console.log(document.formulaire.mdp.value);
                alert('Le mot de passe doit comporter entre 3 et 12 caractères');
            } // fin du if

        } //fin de fonction controleForm



        // Controle du formulaire d'inscription avec la fonction
        // 2eme formulaire

        //récupération du bouton d'envoi
        let formInscription = document.getElementById('formInscription');
        // console.log(btn);
        // ecoutes des cliques sur le bouton / écouteur d'évènement sur le bouton

        formInscription.addEventListener('submit', inscriptionForm);

        function inscriptionForm(e) {
            // e pour event, le e est un classique d'utilisation comme le i de itérator dans if
            e.preventDefault();
            console.log("coucou");

            // console.log(e.target);

            // https://regex101.com
            // expression regulière pour valider les emails
            // sera toujours entre deux / qui remplace new RegExp ("")
            let regex = /([a-z0-9](\.?|\_|\-))*@([a-z0-9]{2,})(\.[a-z]{2,}){1,/;
            // let regex = new RegExp("([a-z0-9](\.?|\_|\-))*@([a-z0-9]{2,})(\.[a-z]{2,}){1,/");

            // récupération des champs grace à value (récupérer la valeur du champs entré par l'utilisateur)
            // techniques pour declarer plusieurs variables d'un coup avec une simple virgule, finissant toujours pas point virgule)
            let prenom = e.target.prenom.value,
                nom = e.target.nom.value,
                email = e.target.email.value,
                mdp2 = e.target.mdp2.value,
                confmdp = e.target.confmdp.value;

            // console.log(prenom, nom, email, mdp2, confmdp);

            if (prenom !== '' || nom !== '') { // prénom et nom ne sont pas vide alors execute ce bloc de code
                if (prenom.length < 2) {
                    // classList représente toutes les classes de l'élément e.target
                    // add ajoute une classe
                    e.target.prenom.classList.add("error");
                    // remove pour supprimer
                    e.target.prenom.classList.remove("valide");

                } else {
                    // toggle va eviter d'écrire les deux lignes pour error et valide
                    // e.target.prenom.classList.toggle("valide", "error");
                    e.target.prenom.classList.remove("error");
                    // remove pour supprimer
                    e.target.prenom.classList.add("valide");
                }

                if (nom.length < 4) {
                    e.target.nom.classList.add("error");
                    e.target.nom.classList.remove("valide");

                }else {
                    // e.target.nom.classList.toggle("valide", "error");
                    e.target.nom.classList.remove("error");
                    e.target.nom.classList.add("valide");
                } 

            }// fin du if si nom et prenom ne sont pas vide
            
            if (mdp2 !== confmdp) {
                e.target.mdp2.classList.add("error");
                e.target.mdp2.classList.remove("valide");

            } else if (mdp2.length < 6 && mdp2.length > 12) {
                e.target.mdp2.classList.add("error");
                e.target.mdp2.classList.remove("valide");
            } else{
                e.target.mdp2.classList.remove("error");
                e.target.mdp2.classList.add("valide");
                e.target.confmdp.classList.add("valide");
                e.target.confmdp.classList.remove("error");
        
            }// fin du if confirmation de mdp

            // console.log(regex.test(email)); //affiche false car l'adresse est vide, ou true si tout est bien rempli
            if(regex.test(email) === false) {
                // if (!regex.test(email)){
                e.target.email.classList.add("error");
                e.target.email.classList.remove("valide");
            } else {
                e.target.email.classList.remove("error");
                e.target.email.classList.add("valide");
            }

        } // fin de function inscriptionForm

        document.getElementById("resetForm").addEventListener("click", function(e) {
            console.log(e.target.form);
            e.target.form.prenom.value="";
            e.target.form.nom.value="";
            e.target.form.email.value="";
            e.target.form.mdp2.value="";
            e.target.form.confmdp.value="";
        });

    </script>


</body>

</html>